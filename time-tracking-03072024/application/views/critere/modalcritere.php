<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/brands.min.css" integrity="sha512-DJLNx+VLY4aEiEQFjiawXaiceujj5GA7lIY8CHCIGQCBPfsEG0nGz1edb4Jvw1LR7q031zS5PpPqFuPA8ihlRA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/fontawesome.min.css" integrity="sha512-UuQ/zJlbMVAw/UU8vVBhnI4op+/tFOpQZVT+FormmIEhRSCnJWyHiBbEVgM4Uztsht41f3FzVWgLuwzUqOObKw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/regular.min.css" integrity="sha512-KYEnM30Gjf5tMbgsrQJsR0FSpufP9S4EiAYi168MvTjK6E83x3r6PTvLPlXYX350/doBXmTFUEnJr/nCsDovuw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/solid.min.css" integrity="sha512-Hp+WwK4QdKZk9/W0ViDvLunYjFrGJmNDt6sCflZNkjgvNq9mY+0tMbd6tWMiAlcf1OQyqL4gn2rYp7UsfssZPA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/svg-with-js.min.css" integrity="sha512-JgLoPAy0vc/kYzFhTyokdFDtyTdsU5TiJQ1zzMHL4aL0QnDdWGC5CnG3FZ7eRhncidUaFoqB7W/Hbs8X0cvzXQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/v4-font-face.min.css" integrity="sha512-WHAIm6Bs8D6XIfh5GerxXJYaZeBxhFlJ7S2ljFv70YpxTF2rLBVfBFXrzS9Fv9WYpeR64Zl256o6UeIpFOrBtg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/v4-shims.min.css" integrity="sha512-veZLkufL0qjcloU3GqyNh2cOqjduXLgni09I72g783Fyudzxcm2A7lxj6Qxn4YrnhJdD8rB9vkR+rOtfF4TZ1g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/v5-font-face.min.css" integrity="sha512-gb3xyfj/FrHtphPVLYaKBZ8WyMYEXD1+Cgt3FiKhFmbN2UuOpite2w1Lgmw6NzfsNmMGX+BbVra4ceV95z9Vaw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/js/all.min.js" integrity="sha512-u3fPA7V8qQmhBPNT5quvaXVa1mnnLSXUep5PS1qo5NRzHwG19aHmNJnj1Q8hpA/nBWZtZD4r4AX6YOt5ynLN2g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/js/brands.min.js" integrity="sha512-ojD9xRtdGdJLd9K/vMhV6GyO8G9wVrofDXmX4AjrKPctyKTLaVVwuAJhZanincPnSprZv1Nc3iDpxIi/6+Xv7A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/js/conflict-detection.min.js" integrity="sha512-e3I3QsLqsuuhMnI0KneOCY3EIIhd55WU/7+hndOQayW2Fur2mdKAhbIEuEFCS/Npx83lqB0XhWzcjJXYIY5a3w==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/js/fontawesome.min.js" integrity="sha512-1M9vud0lqoXACA9QaA8IY8k1VR2dMJ2Qmqzt9pN2AH7eQHWpNsxBpaayV0kKkUsF7FLVQ2sA2SSc8w5VOm7/mg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/js/regular.min.js" integrity="sha512-s0L3HnrNgQ+MciZHcaAlCjhbT5/p8JnZRjuV9CA/4qhX5ywNGy/4j8K6UBkFw5fdt2RVvn6aP4AKfKHhpkrKyA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/js/solid.min.js" integrity="sha512-BR7kmAOY+DL7VrNcDauAY0nOqLp58prNOuwMmes8bd5ET13AAorhPqzbCtH8BsGGG0/TTs9W4Tokbj4tMhFUFw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/js/v4-shims.min.js" integrity="sha512-1eyBIzeEcxyxJkTmQIGLrXo2AK9DVykziyPi7JkNR61HNC8y87OeqQFqvRwgwnqJpjxfUj43Fup0szvPrR3Ilg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
 -->

<div
  class="modal fade"
  id="importCritere"
  tabindex="-1"
  role="dialog"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Import critère</h5>
        <button
          type="button"
          class="close"
          data-bs-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <form
        method="post"
        id="form_critere_import"
        action="<?= site_url('primecritere/importcritere') ?>"
        enctype="multipart/form-data"
      >
        <div class="modal-body">
          <div class="form-group">
            <label for="exampleFormControlFile1"
              >Besoin d'un modèle d'import ?</label
            >
            <button
              type="button"
              class="btn btn-sm btn-default"
              id="download_tpl_import_critere"
            >
              Télécharger
            </button>
          </div>

          <div class="form-group">
            <label for="exampleFormControlFile1"
              >Ajouter le fichier csv d'import d'un critère</label
            >
            <input
              type="file"
              class="form-control-file"
              id="user_file_import"
              name="user_file_import"
              accept=".csv"
            />
          </div>

          <input type="hidden" name="send_edit" value="sent" />
        </div>

        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-secondary"
            data-bs-dismiss="modal"
          >
            Annuler
          </button>
          <button
            type="submit"
            id="save_import"
            value="save_import"
            class="btn btn-primary"
          >
            Lancer l'import
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<div class="modal fade bd-example-modal" id="modalapplycritere" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-md modal-dialog modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
          <h5 class="modal-title" id="staticBackdropLabel">Appliquer un critère</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div><br>
      <h6 class="text-center">Voulez vous appliquer ce critère</h6>
      <input type="hidden" id="id_critere" value=""><br>

      <div class="modal-footer">
            <button type="button" class="btn btn-sm btn-secondary" data-bs-dismiss="modal">Annuler</button>
            <button type="button" id="confirmaapplicationcritere" value="" class="btn btn-primary btn-sm">Valider</button>
        </div>
    </div>
  </div>
</div>

<div class="modal fade bd-example-modal" id="modaldesactivecritere" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-md modal-dialog modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
          <h5 class="modal-title" id="staticBackdropLabel">Supprimer un critère</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div><br>
      <h6 class="text-center">Etes vous sûre de vouloir supprimer ce critere ?</h6><br>
	  <h6 class="text-center">Il est bien de noter que ce critere ne sera pas supprimer tant que la direction ne valide pas</h6><br>

      <input type="hidden" id="id_criteretodesactive" value="">

      <div class="modal-footer">
            <button type="button" class="btn btn-sm btn-secondary" data-bs-dismiss="modal">Non</button>
            <button type="button" id="confirmdesactivationcritere" value="" class="btn btn-primary btn-sm">Oui</button>
        </div>
    </div>
  </div>
</div>

<div
	class="modal fade"
	id="modaladdcritere"
	data-bs-backdrop="static"
	data-bs-keyboard="false"
	tabindex="-1"
	aria-labelledby="modaladdcritere"
	aria-hidden="true"
>
	<div class="modal-dialog modal-lg">
		<div class="modal-content">
			<form id="formaddcritere" method="post" action="<?= site_url('primecritere/insertcritere') ?>">
				<div class="modal-header">
					<h5 class="modal-title">Ajout critère</h5>
					<button
						type="button"
						class="btn-close"
						data-bs-dismiss="modal"
						aria-label="Close"
					></button>
				</div>
				<div class="modal-body">
					<div class="row container">
						<div class="col-md-12">
							<div class="row">
								<div class="col-sm-3">
									<label for="">Libelle:</label>
								</div>
								<div class="col-sm-9">
									<input type="text" id="" class="form-control" name="critere_libelle">
								</div>
							</div><br>
							<div class="row">
								<div class="col-sm-3">
									<label for="Campagne">Campagnes:</label>
								</div>
								<div class="col-sm-9">
									<select name="campagne_critere" id="Criterecampagne" class="form-control">
										<option value=""></option>
									</select>
								</div>
							</div>
							<br />
							<div class="row">
								<div class="col-sm-3">
									<label for="Profil">Profil:</label>
								</div>
								<div class="col-sm-9">
									<select name="profil_critere" id="profil" class="form-control">
										<option value=""></option>
									</select>
								</div>
							</div>
							<br/>
							<div>
								<div class="row">
									<div class="col-sm-3">
										<label for="Process">Process:</label>
									</div>
									<div class="col-sm-9">
										<select
											name="prime_process"
											id="primeprofilprocess"
											class="form-control"
										>
											<option value=""></option>
										</select>
									</div>
								</div>
							</div>
							<br>
							<div>
								<div class ="row">
									<div class = "col-sm-3">
										<label for="">Types :</label>
									</div>
									<div class = "col-sm-9">
										<select class="form-control" name="critere_type" id="TypeCritere">
											<option value=""></option>
										</select>
									</div>
								</div>
								
							</div>
							
							<br>
							<div class="row">
								<div class="col-sm-3">
									<label for="prime_modedecalcul">Mode de calcul:</label>
								</div>
								<div class="col-sm-9">
									<select name="critere_modecalcul" id="prime_modedecalcul" class="form-control">
										<option value=""></option>
									</select>
								</div>
							</div><br>
							<?php /** === Dynamisation de l'objectif === */ ?>
							<div class="row  objectif objectif-default">
								<div class="col-sm-3">
									<label for="prime_modedecalcul">Objectif(s):</label>
								</div>
								
								<div class="col-sm-9">
									<input type="text" id="objectif-value" class="form-control">
								</div>

							</div><br>

							<div class="row  objectif objectif-par-palier">
								<div class="col-sm-3">
									<label for="critere-objectif-par-palier">Palier(s):</label>
								</div>

								<div class="col-sm-9 paliers">
									<div class="row mt-4">
										<div class="col-md-1"><button type="button" id="btn-add-palier" class="btn btn-sm btn-primary"><i class="fa fa-plus"></i></button></div>
										<div class="col-md-11" id="parent-ligne-palier"></div>
									</div>
									
								</div>

							</div><br>
							<input type="hidden" id="critere_objectif" name="critere_objectif">


							<?php /* === END Dynamisation === */ ?>
							<div class="row">
								<div class="col-sm-3">
									<label for="prime_modedecalcul">Base:</label>
								</div>
								<div class="col-sm-9">
									<input type="text" id="" class="form-control" name="critere_base">
								</div>
							</div><br>
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
						Fermer
					</button>
					<button type="submit" id="button" class="btn btn-primary" id="SubtmitCritere">
						Enregister
					</button>
				</div>

			</form>
			
		</div>
	</div>
</div>

<div class="row">
    <div class="col-md-3">
        <button id="addcritere" class="btn btn-primary mx-2" ><i class="fa fa-plus-circle pr-2"></i>Ajouter</button>
		<button id="import-critere" class="btn btn-success mx-2" data-bs-toggle="modal" data-bs-target=""><i class="fa fa-upload pr-2"></i>Importer</button>

    </div>

</div><br>

<div class="row">
		<div class="col-sm-1">
			<label for="Campagne">Campagnes:</label>
		</div>
		<div class="col-sm-3">
			<select name="" id="campagneflitre" class="form-control">
				<option value=""></option>
			</select>
		</div>

		<div class ="col-sm-1"></div>
		<div class="col-sm-1">
			<label for="Campagne">Profil:</label>
		</div>
		<div class="col-sm-3">
			<select name="" id="profilflitre" class="form-control">
				<option value=""></option>
			</select>
		</div>

</div>
<br />

<div class="row">
	<div class="col-md-12">
		<table
			id="TableCritere"
			class="table-striped table-bordered text-center"
			style="width: 100%"
			>
			<thead>
				<tr>
					<th>Critère libelle</th>
					<th>Campagne</th>
					<th>Type</th>
					<th>Profil</th>
					<th>Process</th>
					<th>Objectifs</th>
					<th>Etat</th>
					<th></th>
				</tr>
			</thead>
		</table>
			
	</div>
</div>

<script type="text/javascript">
    $(document).ready(function()
    {
		var id_filter = 0;

		$('.objectif').hide();
		$('.objectif-default').show();

		var TableCritere = $("#TableCritere").DataTable(

		{
			language: {
				url: "<?= base_url('assets/datatables/fr-FR.json'); ?>"
			},
			ajax:  '<?= site_url('primecritere/getprimeallcritere/') ?>',
			columns: [
				{data :"primecritere_libelle"},
				{data:"campagne_libelle"},
				{data :"primetypecritere_libelle"},
				{data:"primeprofil_libelle"},
				{data: "process_libelle"},
				{data :"primecritere_objectif"},
				{ 
				data : null,
					render : function(data, type, row)
					{
						
						if(row.primecritere_etat == '1') 
							return '<h5 id="" class="badge bg-primary h1" style="color:white" data-id_critere = "'+data.primecritere_id+'">En attente de validation</h5>';
						else if(row.primecritere_etat == '2')
							return '<h5 class="badge bg-success badge h3" style="color:white">Appliquer</h5>';
						else if(row.primecritere_etat == '3')
							return '<h5 class="bg-danger badge h3" style="color:white">Non validé</h5>';
						else if(row.primecritere_etat == '4')
							return '<h5 class="bg-danger badge h3" style="color:white">En attente de suppression</h5>';
					}
				}, 
				{
					data : null,
					render: function ( data, type, row ) 
					{

						// return '<button title="modifer" data-id="'+data.primecritere_id+'" class="modifier_critere btn btn-primary btn-sm mr-1"><i class="fa fa-edit"></i></button><button title="supprimer" data-id="'+data.primecritere_id+'" class="desactive_critere btn btn-danger btn-sm mr-1"><i class="fa fa-trash-o"></i></button>';
						return '<button title="supprimer" data-id="'+data.primecritere_id+'" class="desactive_critere btn btn-danger btn-sm mr-1"><i class="fa fa-trash"></i></button>';

					}
				}
			]
						
		});


		function LoadCampagne()
		{
			$('#campagneflitre').html('');
                //On récupère la liste des campagnes via ajax
                $.ajax({
                    url : '<?= site_url('apietp/campagne/') . $top['userid'] ?>',
                    method : 'get',
                    dataType : 'json',
                    success : function(resp){
                        let options = '<option value=""></option>';
                        resp.data.forEach(function(cmp){
                            options += '<option value="'+cmp.campagne_id+'">'+cmp.campagne_libelle+'</option>';
                        })
                        $('#campagneflitre').html(options);

                    } 
                })
		}

		function LoadTypeCritere()
        { 
            $('#TypeCritere').html('');
            $.ajax({
                url : '<?= site_url('apiprimecritere/typecritere') ?>',
                method : 'get',
                dataType : 'json',
                success : function(resp){
                    let options = '<option value=""></option>';
                    resp.data.forEach(function(criteretype){
                        options += '<option value="'+criteretype.primetypecritere_id+'">'+criteretype.primetypecritere_libelle+'</option>';
                    })
                    $('#TypeCritere').html(options);
                } 
            })
        }

		
		function LoadModeCalculPrime()
        { 
            $('#prime_modedecalcul').html('');
            $.ajax({
                url : '<?= site_url('apiprimecritere/getallprimemodecalcul') ?>',
                method : 'get',
                dataType : 'json',
                success : function(resp){
                    let options = '<option value=""></option>';
                    resp.data.forEach(function(modedecalcul){
                        options += '<option value="'+modedecalcul.primemodecalcul_id+'">'+modedecalcul.primemodecalcul_libelle+'</option>';
                    })
                    $('#prime_modedecalcul').html(options);
                } 
            })
        }


		LoadCampagne();
		LoadModeCalculPrime();

        $(document).on("click","#addcritere", function(){
            $('#Criterecampagne').html('');
                //On récupère la liste des campagnes via ajax
                $.ajax({
                    url : '<?= site_url('apietp/campagne/') . $top['userid'] ?>',
                    method : 'get',
                    dataType : 'json',
                    success : function(resp){
                        let options = '<option value=""></option>';
                        resp.data.forEach(function(cmp){
                            options += '<option value="'+cmp.campagne_id+'">'+cmp.campagne_libelle+'</option>';
                        })
                        $('#Criterecampagne').html(options);
                        $("#modaladdcritere").modal("show");

                    } 
                })


        });

        $(".add").click(function() 
        {
            var icon = $(this).find('i');
            if (icon.hasClass('fa-plus')) {
            icon.removeClass('fa-plus').addClass('fa-minus');
			let operateur = "plus";
            } else if (icon.hasClass('fa-minus')) {
            icon.removeClass('fa-minus').addClass('fa-equals');
            } else if (icon.hasClass('fa-equals')) {
            icon.removeClass('fa-equals').addClass('fa-less-than-equal');
            } else if (icon.hasClass('fa-less-than-equal')) {
            icon.removeClass('fa-less-than-equals').addClass('fa-more-than-equal');
            }
            else if (icon.hasClass('fa-more-than-equal')) {
            icon.removeClass('fa-more-than-equals').addClass('fa-plus');
            } 
        });

        $(document).on('change', '#Criterecampagne', function()
        {
			var campagne = $('#Criterecampagne option:selected').val();

			$('#profil').html('');
			//On récupère la liste des profil via ajax
			$.ajax({
				url : '<?= site_url('apiprimecritere/primecritereprofilbycampagne/') ?>' + campagne,
				method : 'get',
				dataType : 'json',
				success : function(resp){
					let optioncritereprofil = '<option value=""></option>';
					resp.data.forEach(function(profil){
						optioncritereprofil += '<option value="'+profil.primeprofil_id+'">'+profil.primeprofil_libelle+'</option>';
					})
					$('#profil').html(optioncritereprofil);
				} 
			})
        })

		$(document).on('change', '#profil', function(){
			$('#primeprofilprocess').html('');
                var profil = $('#profil option:selected').val();
                var campagne = $('#Criterecampagne option:selected').val();
                //On récupère la liste des process via ajax
                $.ajax({
                    url : '<?= site_url('Apiprimecritere/primeprofilprocess/') ?>' + profil + '/' + campagne,
                    method : 'get',
                    dataType : 'json',
                    success : function(resp){
                        let options = '<option value=""></option>';
                        resp.data.forEach(function(process){
                            options += '<option value="'+process.process_id+'">'+process.process_libelle+'</option>';
                        })
                        $('#primeprofilprocess').html(options);
                    } 
                })
		})

		$(document).on('change', '#prime_modedecalcul', function(){
			$('.objectif').hide();
			$('.objectif-default').show();
			let selectedModeCalcul = $(this).val();
			if(selectedModeCalcul == '4'){
				$('.objectif-par-palier').show();
			}
		})

		$(document).on('click', '#btn-add-palier', function(){
			addPalier();
		})

		$(document).on('click', '.delete-ligne-palier', function(){
			deletePalier(this);
		})
		function addPalier()
		{
			let elementBloc = '<div class="row mt-2 ligne-palier">'+
								'<div class="col-md-3 offset-md-1">'+
									'<select name="objectif-par-palier-operator[]" class="form-control objectif-par-palier-operator">'+
										'<option value=""></option>'+
										'<option value="<"><</option>'+
										'<option value="<="><=</option>'+
										'<option value=">">></option>'+
										'<option value=">=">>=</option>'+
									'</select>'+
								'</div>'+
								'<div class="col-md-3">'+
									'<input type="text" class="form-control objectif-par-palier-condition" name="objectif-par-palier-condition[]">'+
								'</div>'+
								'<div class="col-md-1">=></div>'+
								'<div class="col-md-3">'+
									'<input type="text" class="form-control objectif-par-palier-value" name="objectif-par-palier-value[]">'+
								'</div>'+
								'<div class="col-md-1"><button type="button" class="btn btn-sm btn-secondary delete-ligne-palier"><i class="fa fa-trash"></i></button></div>'+
							'</div>'
							;
			$('#parent-ligne-palier').append(elementBloc);
		}

		$('#formaddcritere').on('submit', function(e){
			e.preventDefault();
			setCritereObjectif();
			this.submit();
		})


		function deletePalier(elt)
		{
			$(elt).closest('.ligne-palier').remove();
		}

		function setCritereObjectif()
		{
			let critereObjectif = new Object();
			let objectif = $('#objectif-value').val();
			let palier = new Array();
			$('.ligne-palier').each(function(){
				let ligne = new Object();
				let operator = $(this).find('.objectif-par-palier-operator :selected').val();
				let condition = $(this).find('.objectif-par-palier-condition').val();
				let value = $(this).find('.objectif-par-palier-value').val();
				if(condition && operator && value)
				{
					ligne.condition = condition;
					ligne.operator = operator;
					ligne.value = value;
					palier.push(ligne);
				}
			});
			critereObjectif.objectif = objectif;
			if(palier.length !== 0) critereObjectif.palier = palier;
			jsonCritereObjectif = JSON.stringify(critereObjectif);
			$('#critere_objectif').val(jsonCritereObjectif);
		}

        $(document).on('change','#TypeCritere', function()
        {
            $("#allcriterebase, #allprimequalitesetex").hide();
            let idtypecritere = $('#TypeCritere option:selected').val();

            if (idtypecritere == "1") {
                $("#allcriterebase").show();
            } else if (idtypecritere == "2") {
                $(".Anciennetes, .Volume, .Saison, .QS").hide();
                $("#allprimequalitesetex").show();

            }  
        })

		$(document).on("change", "#campagneflitre", function (){
			id_filter = 0;
			id_filter = $('#campagneflitre option:selected').val();
			TableCritere.ajax.url('<?= site_url('primecritere/getprimecritere/') ?>' + id_filter).load();

			
		});

		$(document).on("click","#validercritere", function()
		{
			let critere_id = $(this).data('id_critere');
			console.log(critere_id);
			$('#modalapplycritere').modal("show");
			$("#id_critere").val(critere_id);

      	});

		$(document).on("click", ".desactive_critere", function()
		{
			let critere_id = $(this).data('id');
			$("#id_criteretodesactive").val(critere_id);
			$('#modaldesactivecritere').modal('show');
		})

		$(document).on("click", "#confirmdesactivationcritere", function()
		{
			let critere_id = $("#id_criteretodesactive").val();
			$.ajax({
                    type:"POST",
                    url: "<?= site_url("primecritere/desactivecriterecadre"); ?>",
                    data: { critere_id : critere_id},
                    success: function(data)
                    {
						TableCritere.ajax.url('<?= site_url('primecritere/getprimecritere/5') ?>').load();
						$('#modaldesactivecritere').modal('hide');

                    }
            })
		})

		$(document).on("click","#import-critere",function(){
			$('#importCritere').modal('show');
		})

		LoadTypeCritere();

		$("#download_tpl_import_critere").on("click", function () 
		{
			$.fileDownload("<?= base_url('template/tpl_import_critere.csv') ?>")
				.done(function () {
				alert("Template telechargé!");
				})
				.fail(function () {
				alert("Erreur telechargement template!");
				});
		});

		
    });

      
</script>